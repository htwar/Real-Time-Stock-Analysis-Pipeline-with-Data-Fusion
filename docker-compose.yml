version: "3.9"

services:
  realtimeprice-service:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: realtimeprice-service
    command: ["uvicorn", "real-time-price:app", "--host", "0.0.0.0", "--port", "8000"]
    # No API key needed anymore
    ports:
      - "8001:8000"
    networks:
      - stocknet

  fundamentaldata-service:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: fundamentaldata-service
    command: ["uvicorn", "fundamental-data:app", "--host", "0.0.0.0", "--port", "8000"]
    # No API key needed anymore
    ports:
      - "8002:8000"
    networks:
      - stocknet

  analysis-service:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: analysis-service
    command: ["streamlit", "run", "UI.py", "--server.port=8000", "--server.address=0.0.0.0"]
    environment:
      PRICE_SERVICE_URL: "http://realtimeprice-service:8000"
      FUNDAMENTAL_SERVICE_URL: "http://fundamentaldata-service:8000"  # ðŸ”§ fixed name
    ports:
      - "8000:8000"
    depends_on:
      - realtimeprice-service
      - fundamentaldata-service
    networks:
      - stocknet

networks:
  stocknet:
    driver: bridge
